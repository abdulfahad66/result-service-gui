{% extends "adm_base.html" %}
{% block titlecontainer %}
  <div class="w3-10"></div>
  <div class="w3-80">
{% endblock %}

{% block titleheader %}
  Passeringer {{ valgt_klasse }}
{% endblock %}

{% block refresh %}{% endblock %}

{% block titlemain %}
  Passeringer {{ registration_mode }}
{% endblock %}

{% block menuitems %}
  <li class=dropdown id=topborder>
    <a href=javascript:void(0) class=dropbtn>Velg modus</a>
    <div class=dropdown-content>
        <a href=timing?event_id={{ event_id }}&registration_mode=start_bib>Start - bib</a>
        <a href=timing?event_id={{ event_id }}&registration_mode=start_check>Start - check</a>
        <a href=timing?event_id={{ event_id }}&registration_mode=lap>Mellomtid</a>
        <a href=timing?event_id={{ event_id }}&registration_mode=finish_bib>Mål - bib</a>
        <a href=timing?event_id={{ event_id }}&registration_mode=finish_place>Mål - place</a>
        <a href=timing?event_id={{ event_id }}&registration_mode=control>Kontroll</a>
    </div>
  </li>
  {% if registration_mode == "control" %}
    <li class=dropdown id=topborder>
      <a href=javascript:void(0) class=dropbtn>Velg klasse</a>
      <div class=dropdown-content>
        <a href=timing?&event_id={{ event_id }}&registration_mode={{ registration_mode }}>Alle</a>
        {% for klasse in raceclasses %}
          <a href=timing?klasse={{ klasse.name }}&event_id={{ event_id }}&registration_mode={{ registration_mode }}>{{ klasse.ageclass_name }}</a>
        {% endfor %}
      </div>
    </li>
  {% endif %}
{% endblock %}

{% block content %}
  {% if registration_mode == "" %}
    <p>
      <b>- Start</b> - registrere starter, skrive inn startnummer.<br>
      <b>- Start</b> - registrere starter, krysse av på liste.<br>
      <b>- Passering</b> - registrere mellomtid.<br>
      <b>- Mål</b> - registrere målpassering, skrive inn startnummer.<br>
      <b>- Mål</b> - registrere målpassering, skrive inn heat-plassering.<br>
      <b>- Kontroll</b> - korringeringer og manglende registreringer.<br>
      <br>
      <br>
  {% elif registration_mode == "control" %}
    <table>
       <tr id=headerblue>
        <td>Løpsklasse</td>
        <td>Første start</td>
        <td>Deltakere</td>
        <td>Heat</td>
      </tr>
      <tr>
        <td>{{ race.raceclass }}</td>
        <td>{{ race.start_time }}</td>
        <td>{{ race.no_of_contestants }}</td>
        <td>{{ race.heat }}</td>
      </tr>
      <tr>
        <td id=spacer colspan=4> </td>
      </tr>
    </table>
    <div id=spacer></div>
    <form action=/timing method=post>
      <table>
         <tr id=headerblue>
          <td>Startnummer</td>
          <td>DNS</td>
          <td>Navn</td>
          <td>Klubb</td>
          <td>Heat</td>
          <td>Passeringspunkt</td>
          <td>Passeringstid</td>
          <td>Plass</td>
        </tr>
        {% for passering in passeringer %}
          <tr>
            <td>{{ passering.bib }}</td>
            <td id=red><input type=checkbox name="dns" value="{{ passering.bib }}"></td>
            <td>{{ passering.name }}</td>
            <td>{{ passering.club }}</td>
            <td>{{ passering.race_id }}</td>
            <td><input type=text name="point_{{ passering.point }}" value="{{ passering.point }}"></td>
            <td><input type=text name="time_{{ passering.bib }}" value="{{ passering.registration_time }}" size=10></td>
            <td><input type=text name="rank_{{ passering.bib }}" value="{{ passering.rank }}" size=5></td>
          </tr>
        {% endfor %}
        <tr>
          <td id=spacer colspan=8> </td>
        </tr>
        <tr>
            <td colspan=7 align=right>
              <input type="hidden" name="event_id" value="{{ event_id }}">
              <input type="submit" name="{{ registration_mode }}" value="  Oppdater  ">
            </td>
            <td></td>
        </tr>
      </table>
    </form>
  {% elif registration_mode == "start_check" %}
    <div id=spacer></div>
    <form action=/timing method=post>
      <table>
         <tr id=headerblue>
          <td width=80>Startnr<input type="hidden" name="bib" value=""></td>
          <td width=150>Startet</td>
          <td width=100>Starttid</td>
          <td>Navn</td>
          <td>Klubb</td>
          <td>Heat</td>
        </tr>
        {% for start in passeringer %}
          <tr>
            <td align=right>{{ start.bib }}</td>
            <td>
              <input type="radio" name="start_{{ start.bib }}" value="OK"><label for="OK">OK</label>
              <input type="radio" name="start_{{ start.bib }}" value="DNS"><label for="OK">DNS</label>
            </td>
            <td>{{ start.starttime }}</td>
            <td>{{ start.name }}</td>
            <td>{{ start.club }}</td>
            <td>{{ start.race }}</td>
          </tr>
        {% endfor %}
        <tr id=spacer>
        </tr>
        <tr>
            <td></td>
            <td colspan=5>
              <input type="hidden" name="event_id" value="{{ event_id }}">
              <input type="submit" name="{{ registration_mode }}" value="  Oppdater  ">
            </td>
        </tr>
      </table>
    </form>
  {% elif registration_mode == "finish_place" %}
    <div id=spacer></div>
    <form action=/timing method=post>
      <table>
         <tr id=headerblue>
          <td width=80>Startnr</td>
          <td width=80>Plass</td>
          <td>Heat</td>
          <td>Navn</td>
          <td>Klubb</td>
        </tr>
        {% for passering in passeringer %}
          <tr>
            <td align=center>{{ passering.bib }}</td>
            <td><input type=text name="place_{{ passering.bib }}" value="" size=5></td>
            <td>{{ passering.race_id }}</td>
            <td>{{ passering.name }}</td>
            <td>{{ passering.club }}</td>
          </tr>
        {% endfor %}
        <tr id=spacer>
        </tr>
        <tr>
            <td></td>
            <td colspan=5>
              <input type="hidden" name="event_id" value="{{ event_id }}">
              <input type="submit" name="{{ registration_mode }}" value="  Oppdater  ">
            </td>
        </tr>
      </table>
    </form>
  {% else %}
    <form action=/timing method=post>
      <table>
        <tr>
          <td id=spacer colspan=3> </td>
        </tr>
        <tr id=headerblue>
          <td>Passeringspunkt</td>
          <td>Startnummer</td>
          <td></td>
        </tr>
        <tr>
          <td id=spacer colspan=3> </td>
        </tr>
        <tr>
          <td>
            {% if registration_mode == "start_bib" %}
              Start
            {% elif registration_mode == "finish_bib" %}
              Mål
            {% else %}
              <select name="point">
                  <option value="forvarsel_1">Forvarsel 1</option>
                  <option value="runde_1">Runde 1</option>
              </select>
            {% endif %}
          </td>
          <td><input type=text name="bib" value=""></td>
          <td>Ved flere passeringer, bruk space mellom startnummer. x før eller etter startnummer indikerer at løper ikke startet. Eksempel: 2 3x 4</td>
        </tr>
        <tr>
          <td></td>
            <td align=right>
              <input type="hidden" name="event_id" value="{{ event_id }}">
              <input type="submit" name={{ registration_mode }} value="  Registrer  ">
            </td>
            <td></td>
        </tr>
      </table>
    </form>
  {% endif %}
{% endblock %}
